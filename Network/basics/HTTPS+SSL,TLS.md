# HTTPS(HyperText Transfer Protocol + Secure Socket)

> 2024.07.23 화요일 수업😎

주먹밥쿵야 잘 지냈어요? HTTP수업 열심히 듣고 왔으리라 생각하고 다음 수업 진행해볼게요. 이번 시간은 HTTPS와 SSL, TLS에 대해 학습해볼게요. 

🤔 **주먹밥쿵야:** 와하하 정말 흥미로운 주제일 것 같아요. 먼저 HTTPS부터 알려주세요. 한번에 와라라 들으면 힘들어요.

그래요! HTTPS는 기존 HTTP에 보안 취약점을 해결하기 위해 생긴 개념이에요.
가끔 주소창을 보면 안전하지 않다는 경고가 뜨죠? 2019년도에 구글이 HTTP 사이트에 대해서는 그러한 경고 표시를 적용하겠다고 권고했어요.
HTTP는 데이터 유출이 발생할 수 있는 위험이 있어서 그래요. 만약 노출되면 안 되는 정보를 전송하면(비밀번호처럼요), 누군가 의도를 가지고 그 정보를 조회할 수 있어요 ㅠㅠ.

😯 **주먹밥쿵야:** 그렇군요. HTTP랑 비슷한데 조금 다른 거 아닌가요? 어떤 점들이 추가되었어요?

먼저 HTTPS는 뭐라고 쓴 건지 알아볼 수 없도록, 뒤죽박죽 엉킨 형태로 정보를 보내요.
그리고 진짜와 가짜를 판별해줘요. 무슨 말이냐면, 쿵야가 피자나라 치킨공주 사이트를 원했을 때
원치 않게 치킨나라 피자공주를 접속하게 될 수도 있잖아요? 나쁜 사람들이 피나치공을 가고 싶은 사람을 노려서 치나피공을 만들 수도 있는 거예요.
만약 거기에서 아이디, 비밀번호를 입력하면 비밀 정보를 나도 모르게 뺏겨 버려요.
치나피공이 아니라 은행같은 사이트면 더 큰일이겠죠?

😳 **주먹밥쿵야:** 헉 그러면 HTTPS는 어떻게 그런 정보들을 서버에서 클라이언트에게 뒤죽박죽 섞어서 보내요?

SSL이나 TLS프로토콜을 통해 세션 데이터를 암호화 한다고 해요.
(SSL의 발전된 버전이 TLS이고, SSL은 더 이상 사용되지 않지만 SSL이란 용어가 많이 사용되고 있어요.)
대칭키, 공개키 방식으로 사용됩니다.

🤔 **주먹밥쿵야:** 대칭키와 공개키.. 그건 뭔가요?

대칭키 방식은 동일한 키로 암호화, 복호화를 수행하는 방법이에요.
주먹밥 쿵야와 주먹밥 쿵야의 친구가 같은 열쇠를 가지고 있어서, 자물쇠로 잠긴 정보를 암호화와 복호화할 수 있는거죠.
하지만 열쇠를 잃어버리거나 누가 훔쳐간다면 자물쇠는 누구나 열 수 있게 되겠죠?
그런 점이 단점이지만, 공개키(비대칭키)와는 다르게 빠르고 쉽고, 부담이 적어요.

공개키 방식은 말 그대로 공개되어 있는 키로 암호화를 수행하는 것인데요,
복호화 시에는 개인키를 사용한다는 점이 달라요. 공개키로 암호화 시킨 데이터는 오직 개인키로만 복호화 할 수 있어요.
그래서 누가 뺏어가도 크게 상관이 없죠. 개인키 발급은 CA(Certificate Authority)라는 기관과 연관이 있어요.
공개키 방식이 안전하지만, 대칭키에 비해 연산시간이 더 소요돼서 비용이 많이 들어요.
SSL은 이러한 대칭키와 공개키의 장단점을 고려해서 두 가지 방식을 적절하게 혼합해서 사용해요.

😲​ **주먹밥쿵야:** 동작 방식이 궁금하네요! 두 방식을 어떻게 혼합하는건가요?
암호화 및 인증 방식을 예를 들어 설명할게요.
암호화 알고리즘, 키 교환 알고리즘에 따라 달라지지만, 일반적으로 사용되는 RSA 키 교환 알고리즘 버전으로 알아볼까요?

```
1. 클라이언트 -> 서버 메세지 전송 - 이때 핸드셰이크가 시작된다. 이 메세지에는 TLS 버전, 암호화 알고리즘, 무작위 바이트 문자열이 포함된다.
2. 서버 -> 클라이언트 메세지 전송 - 클라이언트의 메세지에 응답으로 서버의 SSL인증서, 선택한 암호화 알고리즘, 서버에서 생성한 무작위 바이트 문자열을 포함한 메세지를 전송한다.
3. 인증 - 클라이언트가 서버의 SSL인증서를 인증 발행 기관에 검증한다. 
4. 예비 마스터 암호 - 클라이언트는 무작위 바이트 문자열을 공개 키로 암호화된 premater secret 키를 서버로 전송한다.
5. 개인 키 사용 - 서버가 premaster secret 키를 개인 키를 통해 복호화한다. (개인 키로만 복호화 가능)
6. 세션 키 생성 - 클라이언트와 서버는 클라이언트가 생성한 무작위 키, 서버가 생성한 무작위 키, premaster secret 키를 통해 세션 키를 생성한다. 양쪽은 같은 키가 생성되어야 한다.
7. 클라이언트 완료 전송 - 클라이언트는 세션 키로 암호화된 완료 메세지를 전송한다.
8. 서버 완료 전송 - 서버도 세션 키로 암호화된 완료 메세지를 전송한다.
9. 핸드셰이크 완료 - 핸드셰이크가 완료되고, 세션 키를 이용해 통신을 진행한다.
```

조금 더 시각적으로 보고 싶다면, 아래 링크를 참고해보아요. 한국어 자막을 설정할 수 있어요!</br>
https://youtu.be/j9QmMEWmcfo?si=qWRGtRbZ3qQ02yrU
