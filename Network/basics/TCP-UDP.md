# TCP와 UDP

> 2024.07.26 금요일 수업😎

좋은 아침이에요, 샐러리쿵야 학생!   
이른 시간부터 고생이 많아요. 식사는 하고 왔...

🥬 **샐러리쿵야:** 선생님 시간이 없으니까 빨리 수업 진행해주시죠. 오늘 주제는 TCP와 UDP죠?

아 네 맞아요... 샐러리쿵야 학생의 학구열이 이렇게 훌륭할 줄 몰랐네요.   
그럼 오늘의 수업 시작할게요.   
TCP와 UDP는 인터넷에서 데이터를 보내는 두 가지 방법이에요.

🥬 **샐러리쿵야:** 각각의 특징과 차이점을 아는 게 중요하겠군요.

네? 네 그렇죠...   
혹시 샐러리쿵야 학생은 TCP가 무엇의 약자인지 알고 있나요?

🥬 **샐러리쿵야:** Transmission Control Protocol입니다.

와 맞아요...!   
그리고 UDP는

🥬 **샐러리쿵야:** User Datagram Protocol입니다.

아니 이건 선생님이 말하려고 했는데...   
아무튼 둘 다 인터넷에서 데이터를 전송할 때 사용하는 방법이지만, 그 방식이 많이 다르답니다.

🥬 **샐러리쿵야:** 무엇이 어떻게 다릅니까?

먼저 TCP에 대해 설명할게요...?   
TCP는 데이터를 보내기 전에 먼저 연결을 확립하는 방법이랍니다.   
송신자와 수신자 사이에 연결이 만들어져야 데이터를 보내고, 받은 데이터를 확인한 뒤 만약 데이터가 손실되었다면 다시 보내는 과정을 거쳐요.

🥬 **샐러리쿵야:** 전달되는 데이터의 정확성을 보장할 수 있겠군요.

네, 다만

🥬 **샐러리쿵야:** 대신 속도가 좀 느리겠네요.

...

🥬 **샐러리쿵야:** 선생님? UDP에 대해 마저 설명해주시죠.

...네!   
UDP는 TCP와 달리, 연결을 확립하지 않고 바로 데이터를 보내요.   
각 데이터는 독립적으로 처리돼서 손실되거나 순서가 바뀔 수 있지만, 속도가 빠르다는 장점이 있어요.   

🥬 **샐러리쿵야:** 시간에 민감한 서비스에서 사용되나요?

네... 실시간 게임이나 스트리밍, 화상 통화 같은 서비스를 예시로 들 수 있겠네요.

🥬 **샐러리쿵야:** TCP는 주로 어떤 상황에서 사용되죠?

TCP는 데이터가 정확하게 전달되는 게 중요한 경우 사용된답니다.   
웹 페이지를 볼 때나 이메일을 보낼 때, 파일을 전송할 때 등이 되겠네요.   
이런 경우 데이터가 정확하게 전달되는 것이 중요하기 때문에, TCP가 더 적합한 방식이에요.

🥬 **샐러리쿵야:** 앞서 TCP는 연결을 먼저 확립한다고 하셨는데.

네? 네... (왜 청문회 같은 기분이 들지?)

🥬 **샐러리쿵야:** 연결을 확립한다는 게 무슨 의미죠?

오, 좋은 질문이네요! TCP 연결을 확립하는 과정을 '3-way handshake'라고 하는데요,   
송신자가 수신자에게 연결 요청(SYN)을 보내고, 수신자는 그 요청을 받아들였다는 응답(SYN-ACK)을 보냅니다.   
그리고 마지막으로 송신자가 확인 응답(ACK)을 보내면 연결이 확립돼요.   
이 과정을 통해 서로 연결되었음을 확인하고 데이터를 주고받을 준비를 하는 거죠.

🥬 **샐러리쿵야:** 세 단계라서 3-way군요.

네 맞아요!

🥬 **샐러리쿵야:** 4-way handshake도 있다고 알고 있는데요.

그것도 맞아요! 다른 선생님께 배우셨나요?

🥬 **샐러리쿵야:** 아니요.

그럼 예습...?   
아무튼, 3-way handshake가 TCP의 연결 과정이었다면 4-way handshake는 TCP의 연결 해제 과정이랍니다.   
(TCP는 두 가지 연결 해제 방식이 있는데, 그 중 하나가 4-way handshake, 다른 하나는 RST을 통한 연결 해제예요!)   
첫 번째로 클라이언트가 서버에게 연결 종료를 요청하는 FIN 세그먼트를 보내면,   
서버는 FIN을 받은 뒤 확인했다는 ACK를 클라이언트에게 보낸답니다. 그리고 자신의 통신이 끝날때까지 기다려요. 아직 남은 데이터가 있다면 다 보내고 나서 종료해야 하거든요.   
서버가 데이터를 모두 보냈다면, 연결 종료에 합의 한다는 의미로 FIN 패킷을 클라이언트에게 보내는데요,   
아까 서버가 그랬던 것처럼 클라이언트 또한 FIN을 받고서 서버에 응답 ACK를 보내준답니다.

🥬 **샐러리쿵야:** FIN-ACK-FIN-ACK의 네 단계라고 볼 수 있겠네요.

이해력이 정말 빠르네요!

🥬 **샐러리쿵야:** UDP는 그런 연결 확립 과정이 없나요?

네, UDP는 연결 설정 과정이 없어요. 데이터를 그냥 바로 보내죠.   
그래서 데이터를 빠르게 보낼 수 있지만, 손실되거나 순서가 뒤바뀔 수 있답니다.

🥬 **샐러리쿵야:** TCP와 UDP 중에 무엇을 사용해야 하는지는 상황에 따라 달라지겠군요.

그렇죠. 데이터가 정확하게 전달되는 게 중요하다면 TCP를, 속도가 중요하고 약간의 데이터 손실을 감수할 수 있다면 UDP를 선택하면 돼요.   

🥬 **샐러리쿵야:** 뭔가 와닿지 않는데요. 예를 들자면, 웹 페이지를 방문할 때 사용되는 프로토콜은 어떤 것이죠?

그럼 웹 페이지에 접속하는 예시를 들어볼까요?   
이런 경우에는 주로 TCP가 사용되는데요, 주소창에 URL을 입력하고 Enter를 누르면 첫 번째로...

🥬 **샐러리쿵야:** DNS 조회가 일어나죠.

...아 네 맞아요.   
브라우저가 URL의 도메인 이름을 IP 주소로 바꾸기 위해 DNS 서버에 질문하고, 이 과정에서 UDP가 사용된답니다.   
DNS 요청과 응답은 UDP로 빠르게 주고받을 수 있거든요. DNS 조회에 실패하면 다시 시도해서 신뢰성을 어느 정도 보장해줘요.   

🥬 **샐러리쿵야:** 그러고 나서 웹 페이지 요청은요?

브라우저가 IP 주소를 받으면 TCP 연결을 시작하는데요, 여기서 3-way handshake가 일어나는 거예요.   
브라우저가 서버에 연결 요청(SYN)을 보내고,   
서버가 그 요청을 받고 응답(SYN-ACK)을 보내죠.   
브라우저가 확인 응답(ACK)을 보내면 연결이 확립되고요.   
여기까지 되면 브라우저와 서버가 데이터를 주고받을 준비가 된 거예요.   

🥬 **샐러리쿵야:** 연결이 확립된 후에는 어떤 일이 벌어집니까?

연결이 확립된 후 브라우저는 HTTP 요청을 보내는데요, 예를 들어, 웹 페이지의 HTML 문서를 요청한다고 해볼까요?   
이 요청은 TCP로 전송돼요. 서버는 요청을 받고 HTML 문서를 TCP로 브라우저에 보내는데, 이 과정에서 데이터가 손실되면 TCP는 자동으로 손실된 데이터를 다시 보내준답니다.

🥬 **샐러리쿵야:** 그럼 웹 페이지의 이미지나 스타일시트 같은 다른 것들도 TCP로 전송되는 건가요?

맞아요. 웹 페이지를 구성하는 모든 요소는 TCP로 전송돼요.   
각 요소에 대해 별도의 HTTP 요청과 응답이 이루어지고, 이 모든 과정에서 TCP가 사용되죠.

🥬 **샐러리쿵야:** 왜 UDP는 이 과정에서 사용되지 않죠?

웹 페이지는 텍스트, 이미지, 스타일시트 등 여러 요소들로 구성되어 있잖아요?   
이 모든 요소들이 제대로 로드되려면 데이터가 정확히 전달되어야 해요. 데이터의 정확성과 신뢰성을 보장하는 TCP의 특징이 웹 페이지를 로드할 때 적합하죠.   
그래서 웹 페이지를 방문하는 과정에서는 대부분 TCP가 사용되는 거랍니다.   

🥬 **샐러리쿵야:** 그래도 사용되는 데가 있긴 할 것 같은데요.

음... 웹 페이지에서 동영상을 재생할 때 실시간 스트리밍 서비스가 UDP를 사용할 수 있겠네요.   
빠른 전송이 중요하고 약간의 데이터 손실이 허용되니까요.

🥬 **샐러리쿵야:** 감사합니다. 오늘 수업 만족했습니다.

휴... 더 궁금한 것이 있으면 언제든지 구글링을 통해 스스로 찾아보시길 바랄게요.
샐러리쿵야 학생이라면 가능할 것 같아요.
오늘 공부도 화이팅!


